WITH CTE AS( SELECT CASE WHEN OCCUPATION = 'Doctor' THEN NAME END AS DOCTOR, CASE WHEN OCCUPATION = 'Professor' THEN NAME END AS PROF, CASE WHEN OCCUPATION = 'Singer' THEN NAME END AS SINGER, CASE WHEN OCCUPATION = 'Actor' THEN NAME END AS ACTOR, ROW_NUMBER() OVER(PARTITION BY OCCUPATION ORDER BY NAME) AS RN FROM OCCUPATIONS) SELECT MAX(DOCTOR), MAX(PROF), MAX(SINGER), MAX(ACTOR) FROM CTE GROUP BY RN;
